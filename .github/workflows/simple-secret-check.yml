name: ‚úÖ Simple Secret Check

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  check-and-guide:
    name: üîê Check Secrets Status
    runs-on: ubuntu-latest
    
    steps:
    - name: üìã Secret Status Check
      run: |
        echo "üîç GitHub Secrets Status Check"
        echo "=============================="
        echo ""
        echo "Repository: ${{ github.repository }}"
        echo "Workflow: Simple Secret Validation"
        echo ""
        
        # Count configured secrets
        CONFIGURED=0
        MISSING=0
        
        echo "üìã Checking required secrets:"
        echo "-----------------------------"
        
        if [ -n "$MONICA_API_KEY" ]; then
          echo "‚úÖ MONICA_API_KEY: Configured"
          ((CONFIGURED++))
        else
          echo "‚ùå MONICA_API_KEY: Missing"
          ((MISSING++))
        fi
        
        if [ -n "$JWT_SECRET" ]; then
          echo "‚úÖ JWT_SECRET: Configured"  
          ((CONFIGURED++))
        else
          echo "‚ùå JWT_SECRET: Missing"
          ((MISSING++))
        fi
        
        if [ -n "$DB_PASSWORD" ]; then
          echo "‚úÖ DB_PASSWORD: Configured"
          ((CONFIGURED++))
        else
          echo "‚ùå DB_PASSWORD: Missing"
          ((MISSING++))
        fi
        
        if [ -n "$REDIS_PASSWORD" ]; then
          echo "‚úÖ REDIS_PASSWORD: Configured"
          ((CONFIGURED++))
        else
          echo "‚ùå REDIS_PASSWORD: Missing"
          ((MISSING++))
        fi
        
        echo ""
        echo "üìä Summary:"
        echo "----------"
        echo "‚úÖ Configured: $CONFIGURED"
        echo "‚ùå Missing: $MISSING"
        echo ""
        
        if [ $MISSING -gt 0 ]; then
          echo "‚ö†Ô∏è ACTION NEEDED:"
          echo "Add the missing secrets at:"
          echo "üîó https://github.com/${{ github.repository }}/settings/secrets/actions"
          echo ""
          echo "üìã Secrets to add:"
          [ -z "$MONICA_API_KEY" ] && echo "- MONICA_API_KEY = sk-vj0VTDNuoEXtCZ9iwGEOWf96NBGGyvnIWmiVGAp6uBGGNh8r-6T8oWSOk9xhLsgvOyA1sOEPbyEUjKUBkngHC_gpFV4O"
          [ -z "$JWT_SECRET" ] && echo "- JWT_SECRET = NightGodTarotSecure2024JWTTokenSigningKey32CharMin4Ultimate"
          [ -z "$DB_PASSWORD" ] && echo "- DB_PASSWORD = NightGod2024SecureDBPass4UltimateTarotSystem"
          [ -z "$REDIS_PASSWORD" ] && echo "- REDIS_PASSWORD = NightGod2024SecureRedisPass4CachingSystem"
          echo ""
          echo "üéØ This workflow shows SUCCESS even with missing secrets"
          echo "üìà Once you add them, your main CI/CD will work perfectly!"
        else
          echo "üéâ All secrets configured! Your GitHub Actions are ready!"
          echo "‚úÖ Monica AI connection should work"
          echo "‚úÖ CI/CD pipeline will run successfully"  
          echo "‚úÖ Deployment will have access to API keys"
        fi
        
      env:
        MONICA_API_KEY: ${{ secrets.MONICA_API_KEY }}
        JWT_SECRET: ${{ secrets.JWT_SECRET }}
        DB_PASSWORD: ${{ secrets.DB_PASSWORD }}
        REDIS_PASSWORD: ${{ secrets.REDIS_PASSWORD }}